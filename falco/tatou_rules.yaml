- list: tatou_sensitive_files
  items:
    - /app/server_priv.asc
    - /app/flag
    - /home/lab/softsec-tatou/flag

- rule: Tatou Sensitive file was read
  desc: Detect access to Tatou private keys and flag files.
  condition: >
    (open_read and container and fd.name in (tatou_sensitive_files)) or (open_read and not container and fd.name in (tatou_sensitive_files))
  output: >
    Tatou sensitive file read |
    file=%fd.name user=%user.name user_uid=%user.uid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty
  priority: WARNING

- rule: Tatou Sensitive file was tampered with
  desc: Detect writes to Tatou private keys or flag files.
  condition: >
    open_write and container and fd.name in (tatou_sensitive_files)
  output: >
    Tatou sensitive file write |
    file=%fd.name user=%user.name user_uid=%user.uid process=%proc.name proc_exepath=%proc.exepath parent=%proc.pname command=%proc.cmdline terminal=%proc.tty
  priority: CRITICAL
